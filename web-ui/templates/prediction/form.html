{% extends "base.html" %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="text-center mb-5">
                <div class="d-inline-flex align-items-center justify-content-center bg-primary bg-opacity-10 p-3 rounded-circle mb-3">
                    <i class="bi bi-magic text-primary fs-2"></i>
                </div>
                <h1 class="fw-bold text-white">Yapay Zeka Değerleme</h1>
                <p class="text-muted">Evinizin özelliklerini girin, tahmini piyasa değerini anında öğrenin.</p>
            </div>

            <div class="card border-0 shadow-lg">
                <div class="card-body p-4 p-md-5">
                    <form method="post" action="/prediction/estimate">
                        <div class="row g-3 mb-3">
                            <div class="col-md-6">
                                <label class="form-label text-muted small fw-bold">KONUM</label>
                                <select name="location" class="form-select form-select-lg">
                                    <option value="Buca Merkez" {% if input and input.location == 'Buca Merkez' %}selected{% endif %}>Buca Merkez</option>
                                    <option value="Şirinyer" {% if input and input.location == 'Şirinyer' %}selected{% endif %}>Şirinyer</option>
                                    <option value="Tınaztepe" {% if input and input.location == 'Tınaztepe' %}selected{% endif %}>Tınaztepe</option>
                                    <option value="Yıldız" {% if input and input.location == 'Yıldız' %}selected{% endif %}>Yıldız</option>
                                    <option value="Hasanağa" {% if input and input.location == 'Hasanağa' %}selected{% endif %}>Hasanağa</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label text-muted small fw-bold">ODA SAYISI</label>
                                <select name="room_count" class="form-select form-select-lg">
                                    <option value="1+1" {% if input and input.room_count == '1+1' %}selected{% endif %}>1+1</option>
                                    <option value="2+1" {% if input and input.room_count == '2+1' %}selected{% endif %}>2+1</option>
                                    <option value="3+1" {% if input and input.room_count == '3+1' %}selected{% endif %}>3+1</option>
                                    <option value="4+1" {% if input and input.room_count == '4+1' %}selected{% endif %}>4+1</option>
                                </select>
                            </div>
                        </div>

                        <div class="row g-3 mb-3">
                            <div class="col-6">
                                <label class="form-label text-muted small fw-bold">NET M²</label>
                                <input type="number" name="net_area" class="form-control" value="{{ input.net_area if input else '' }}" required>
                            </div>
                            <div class="col-6">
                                <label class="form-label text-muted small fw-bold">BRÜT M²</label>
                                <input type="number" name="gross_area" class="form-control" value="{{ input.gross_area if input else '' }}" required>
                            </div>
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <label class="form-label text-muted small fw-bold">KAT</label>
                                <input type="text" name="floor" class="form-control" value="{{ input.floor if input else '' }}" required>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label text-muted small fw-bold">BİNA YAŞI</label>
                                <select name="building_age" class="form-select">
                                    <option value="0-5" {% if input and input.building_age == '0-5' %}selected{% endif %}>0-5 Yaş</option>
                                    <option value="5-10" {% if input and input.building_age == '5-10' %}selected{% endif %}>5-10 Yaş</option>
                                    <option value="11-15" {% if input and input.building_age == '11-15' %}selected{% endif %}>11-15 Yaş</option>
                                    <option value="16+" {% if input and input.building_age == '16+' %}selected{% endif %}>16+ Yaş</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label text-muted small fw-bold">ISITMA</label>
                                <select name="heating_type" class="form-select">
                                    <option value="Doğalgaz (Kombi)" {% if input and input.heating_type == 'Doğalgaz (Kombi)' %}selected{% endif %}>Doğalgaz</option>
                                    <option value="Klima" {% if input and input.heating_type == 'Klima' %}selected{% endif %}>Klima</option>
                                    <option value="Merkezi" {% if input and input.heating_type == 'Merkezi' %}selected{% endif %}>Merkezi</option>
                                </select>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary w-100 py-3 fw-bold fs-5 mb-4">
                            <i class="bi bi-calculator me-2"></i> FİYATI HESAPLA
                        </button>
                    </form>

                    {% if result %}
                    <div class="alert alert-success border-0 bg-success bg-opacity-10 text-center py-4">
                        <h5 class="text-success mb-2">Tahmini Piyasa Değeri</h5>
                        <div class="display-4 fw-bold text-success mb-3">{{ "{:,.0f}".format(result) }} ₺</div>

                        <a href="/listings/create?price={{ result }}&location={{ input.location }}&room_count={{ input.room_count }}&net_area={{ input.net_area }}&gross_area={{ input.gross_area }}&floor={{ input.floor }}&building_age={{ input.building_age }}&heating_type={{ input.heating_type }}"
                           class="btn btn-success fw-bold px-5 py-2">
                           <i class="bi bi-check-lg me-2"></i> Bu Fiyatla İlan Oluştur
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
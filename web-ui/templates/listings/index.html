{% extends "base.html" %}

{% block content %}
<section class="bg-primary text-white text-center py-5 mb-5 hero-section">
    <div class="container">
        <h1 class="display-4 fw-bold mb-3">Hayalinizdeki Evi Buca'da Bulun</h1>
        <p class="lead mb-4">En güncel emlak verileri ve yapay zeka destekli fiyat tahminleriyle yanınızdayız.</p>
        
        <div class="d-flex justify-content-center gap-3">
            <a href="#listings-container" class="btn btn-light btn-lg text-primary fw-bold">
                <i class="bi bi-search me-2"></i>İlanlara Göz At
            </a>

            {% if user_role == 'agent' %}
                <a href="/listings/create" class="btn btn-outline-light btn-lg fw-bold">
                    <i class="bi bi-plus-circle me-2"></i>Ücretsiz İlan Ver
                </a>
            {% elif user_role == 'user' %}
                {% else %}
                <a href="/auth/login?msg=Ilan_vermek_icin_once_giris_yapmalisiniz" class="btn btn-outline-light btn-lg fw-bold">
                    <i class="bi bi-person-lock me-2"></i>Giriş Yap ve İlan Ver
                </a>
            {% endif %}
        </div>
    </div>
</section>

<div class="container mb-5" id="listings-container">
    
    {% if error %}
    <div class="alert alert-danger" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ error }}
    </div>
    {% endif %}

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold text-white"><i class="bi bi-grid-3x3-gap-fill me-2 text-primary"></i>Son Eklenen İlanlar</h2>
        
        <button class="btn btn-dark border-secondary text-light btn-sm">
            <i class="bi bi-funnel"></i> Filtrele
        </button>
    </div>

    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        {% for listing in listings %}
        <div class="col">
            <div class="card h-100 border-0 shadow-sm card-hover-effect">
                <div class="position-relative">
                    <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=600&q=80" 
                         class="card-img-top" alt="Ev Görseli" style="height: 200px; object-fit: cover;">
                    <span class="badge bg-primary position-absolute top-0 end-0 m-3 shadow">Satılık</span>
                </div>
                
                <div class="card-body">
                    <h5 class="card-title fw-bold text-white mb-1">{{ listing.title }}</h5>
                    <p class="text-muted small mb-3"><i class="bi bi-geo-alt-fill text-danger"></i> {{ listing.location_details.street_name }}</p>
                    
                    <div class="d-flex justify-content-between text-muted small mb-3">
                        <span><i class="bi bi-door-open-fill"></i> {{ listing.property_specs.room_count }} Oda</span>
                        <span><i class="bi bi-bounding-box"></i> {{ listing.property_specs.net_m2 }} m²</span>
                        <span><i class="bi bi-layers-fill"></i> {{ listing.property_specs.floor }}. Kat</span>
                    </div>

                    <h4 class="fw-bold text-success mb-0">{{ listing.price }} ₺</h4>
                </div>
                
                <div class="card-footer bg-transparent border-top border-secondary border-opacity-25 p-3">
                    <a href="/listings/{{ listing['id'] }}" class="btn btn-outline-primary w-100 stretched-link">
                        Detayları Gör <i class="bi bi-arrow-right ms-1"></i>
                    </a>
                </div>
            </div>
        </div>
        {% else %}
        <div class="col-12 text-center py-5">
            <p class="text-muted fs-5">Henüz hiç ilan eklenmemiş.</p>
        </div>
        {% endfor %}
    </div>
</div>

<style>
    /* Hero Section Özel Stili */
    .hero-section {
        background: linear-gradient(rgba(33, 37, 41, 0.8), rgba(33, 37, 41, 0.8)), url('https://images.unsplash.com/photo-1582407947304-fd86f028f716?auto=format&fit=crop&w=1920&q=80');
        background-size: cover;
        background-position: center;
    }
    
    /* Kart Hover Efekti */
    .card-hover-effect {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        background-color: var(--bg-card);
    }
    .card-hover-effect:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.3) !important;
    }
</style>
{% endblock %}